# Вышел Firebird 4.0

Сегодня выпущен Firebird 4.0 — седьмой основной релиз СУБД Firebird, разработка которой началась в 2016 году. Ключевыми задачами при разработке Firebird 4.0 было повышение доступности баз данных (синхронная и асинхронная логическая репликация). 

Одним из самых важных улучшений в Firebird 4.0 стало изменение подхода к созданию согласованного представления о состоянии базы данных, видимого для выполняющихся транзакций. Это позволило решить проблему согласованного чтения на уровне запроса в транзакциях Read Committed, а также ввести так называемую промежуточную сборку мусора. Промежуточная сборка мусора позволяет дополнительно сократить длину цепочки версий при наличии длительных активных транзакций.

Среди важных улучшений также можно отметить поддержку чисел с точностью более 18 цифр, улучшение точности вычислений для более коротких чисел, поддержка часовых поясов, увеличение длины имён метаданных до 63 символов, улучшение подсистемы безопасности, физический standby на основе nbackup, таймауты простоя соединения и выполнения SQL запроса, Batch API, а также множество новые возможностей языка SQL.

Далее мы перечислим ключевые улучшения сделанные в Firebird 4.0 и их краткое описание. Подробное описание всех изменений можно прочитать в "Firebird 4.0 Release Notes".

## Логическая репликация

В Firebird 4.0 предоставляет встроенную поддержку однонаправленной логической репликации. Реализация в первую очередь направлена на обеспечение высокой доступности, но может использоваться и для других задач. 

Репликация отслеживает следующий события:
* добавление, обновление и удаление записей в таблицах
* изменение последовательностей (генераторов)
* DDL операторы

Поддерживается синхронный и асинхронный режим.

При синхронной репликации основная (главная) база данных постоянно подключена к реплике (подчиненным) базам данных, и изменения реплицируются немедленно. По сути, базы данных синхронизируются после каждой фиксации каждой транзакции, что может повлиять на производительность из-за дополнительного сетевого трафика.

При асинхронной репликации изменения записываются в файлы локального журнала, которые передаются по сети и применяются к базе данной реплике. Влияние на производительность намного меньше, но вызывает задержку — отставание репликации — пока изменения ожидают применения к базе данных реплики, т.е. база данных реплики всегда «догоняет» основную базу данных. 

## Физический standby с использованием nbackup

Утилита nBackup в Firebird 4 может выполнять физическое резервное копирование, которое использует GUID (UUID) самой последней резервной копии базы данных, доступной только для чтения. Приращения из исходной базы данных можно непрерывно применять к резервной базе данных, устраняя необходимость сохранять и применять все приращения с момента последней полной резервной копии.

Новый стиль «горячего» резервного копирования и слияния с резервной базой данных можно запустить, не затрагивая существующую многоуровневую схему резервного копирования в действующей базе данных. 

## Поддержка международных часовых поясов 

В Firebird 4.0 введены новые типы данных `TIME WITH TIME ZONE` и `TIMESTAMP WITH TIME ZONE` для поддержки даты и времени с часовыми поясами, а также типы `TIME WITHOUT TIME ZONE` и `TIMESTAMP WITHOUT TIME ZONE` как псевдонимы существующих типов `TIME` и `TIMESTAMP`.

Поддерживаются выражения и операторы для работы с типами с часовыми поясами, а также преобразование между типами данных без/с часовыми поясами.

## Пул внешних соединений
